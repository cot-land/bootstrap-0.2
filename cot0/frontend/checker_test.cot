// Checker Test - Tests for checker.cot
// Run with: ./zig-out/bin/cot cot0/frontend/checker_test.cot -o /tmp/checker_test && /tmp/checker_test

import "checker.cot"

fn main() i64 {
    let result: i64 = 0;

    result = result + test_names_equal();
    result = result + test_type_valid_fn();

    return result;
}

// ============================================================================
// Test: names_equal function
// ============================================================================

fn test_names_equal() i64 {
    // Test equal names
    let name1: string = "hello";
    let name2: string = "hello";

    if not names_equal(name1.ptr, 0, 5, name2.ptr, 0, 5) { return 1; }

    // Test different names
    let name3: string = "world";
    if names_equal(name1.ptr, 0, 5, name3.ptr, 0, 5) { return 2; }

    // Test different lengths
    let name4: string = "helloworld";
    if names_equal(name1.ptr, 0, 5, name4.ptr, 0, 10) { return 3; }

    // Test substrings
    // "ello" starting at offset 1 vs "ello" in "bello"
    let name5: string = "bello";
    if not names_equal(name1.ptr, 1, 4, name5.ptr, 1, 4) { return 4; }

    return 0;
}

// ============================================================================
// Test: type_valid function (from types.cot)
// ============================================================================

fn test_type_valid_fn() i64 {
    // Valid indices should return true
    if not type_valid(0) { return 10; }
    if not type_valid(5) { return 11; }
    if not type_valid(12) { return 12; }

    // Negative indices should return false
    if type_valid(-1) { return 13; }
    if type_valid(-100) { return 14; }

    return 0;
}
